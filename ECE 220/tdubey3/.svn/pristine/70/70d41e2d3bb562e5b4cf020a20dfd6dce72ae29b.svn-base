.ORIG x3000

LD R1, INPUT    
JSR FIBON
ST R6, RESULT
HALT

;your code goes here
FIBON
	AND R2, R2, #0
	AND R3, R3, #0
	ADD R2, R2, #2
	NOT R2, R2
	ADD R2, R2, #1 ; TWOS COMP R2
	ADD R3, R2, R1 ; CHECK R1 VAL
	BRnz FINISHTWO
	AND R2, R2, #0 ; RESET R2 (FLOW)
	AND R3, R3, #0 ; RESET R3 (FHIGH)
	AND R4, R4, #0 ; RESET R4 (RESULT)
	ADD R2, R2, #1
	ADD R3, R3, #1 ; INIT R2, R3
	ADD R1, R1, #-2; DECREMENT COUNT FOR CHECK
LOOP
	ADD R4, R3, R2
	AND R5, R5, #0 ; TEMP REG
	ADD R5, R5, R2 ;
	AND R2, R2, #0 ; CLEAR R2
	ADD R2, R3, R2 ; LOAD R3->R2
	AND R3, R3, #0 ; CLEAR R3
	ADD R3, R4, R3 ; LOAD SUM->R3
	ADD R1, R1, #-1; DECREMENT COUNT
	BRz FINISHG
	BRnzp LOOP
FINISHTWO
	AND R6, R6, #0 ; IF INPUT IS TWO
	ADD R6, R6, #1 ; RETURN 1
	RET
FINISHG
	AND R6, R6, #0;
	ADD R6, R6, R4
	BRn FINISHERR ; IF OVERFLOW OCCURS< GOTO ERR
	RET
FINISHERR
	AND R6, R6, #0 ; CLEAR R6
	ADD R6, R6, #-1; LOAD -1 INTO R6
	RET


INPUT 	.FILL x0005
RESULT	.BLKW #1
.END
